// Bend/Fun/Book/map_rules

Bend/Fun/Book/map_rules (f: Bend/Fun/Rule/Rule -> Bend/Fun/Rule/Rule) (book: Bend/Fun/Book/Book) : Bend/Fun/Book/Book
  let map_def = (x => Bend/Fun/FnDef/FnDef.new 
    (Bend/Fun/FnDef/FnDef.name x)
    (Bend/Fun/FnDef/FnDef.type x)
    (Bend/Fun/FnDef/FnDef.check x)
    (List/map f (Bend/Fun/FnDef/FnDef.rules x))
    (Bend/Fun/FnDef/FnDef.src x))
  let #Book{defs adts ctrs} = book
  let defs = (BinMap/map defs map_def)
  #Book{defs adts ctrs}
